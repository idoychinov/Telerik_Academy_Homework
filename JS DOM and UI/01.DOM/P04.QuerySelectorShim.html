<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Query selector Shim</title>
</head>
<body>
    <div>
        <p>
            <a>First</a>
            <a>Second</a>
        </p>
    </div>
    <script>
        /* 4. Write a script that shims querySelector and querySelectorAll in older browsers*/
        // Unfinished
        (function () {
            if (!document.querySelectorAll) {
                document.querySelectorAll = function (selector) {

                    var documentHead = document.documentElement.firstChild;
                    var styleTag = document.createElement("style");
                    documentHead.appendChild(styleTag);
                    document.querySelectorResult = [];
                   
                    styleTag.style.cssText = selector + "{x:expression(document.querySelectorResult.push(this))}";
                    window.scrollBy(0, 0);
                    documentHead.removeChild(styleTag);

                    var result = [];

                    for (var element in document.querySelectorResult) {
                        result.push(document.querySelectorResult[i]);
                    }

                    return result;
                }
            }

            if (!document.querySelector) {
                document.querySelector = function (selector) {
                    return document.querySelectorAll(selector)[0];
                }
            }           
        })();
        var element = document.querySelector("div p a:last-child");
        console.log(element.innerHTML);
    </script>
</body>
</html>
